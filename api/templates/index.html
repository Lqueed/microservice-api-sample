<!DOCTYPE html>
<html>

<head>
  <title>Main and only page</title>
</head>

  <body>
    <h3>First enter file name and upload image, then click Download to get responce</h3>
    <form method=post enctype=multipart/form-data>
      <input type=file name=file required>
      <input type=submit value=Upload name="upload"><br>
      <input type=text name=filename id="uploadName" required><br>
    </form>
    <form method=post enctype=multipart/form-data>
      <input type=text name=downloadName id="downloadName" value="" style="display:none"><br>
      <input type=text name=filename id="nameToDownload" style="display:none"><br>
      <div style="display:none" id="downloadButton">{{ uploadedFile }} <input type=submit value="Download" name="download"></div>
      <div style="display:none" id="readyError">{{ readyErr }}</div>
    </form>
  </body>
</html>

<script>
  let uploadedFile = "{{ uploadedFile }}"
  let task_id = "{{ task_id }}"
  let readyErr = "{{ readyErr }}"
  let textField = document.getElementById("downloadName")
  let nameToDownload = document.getElementById("nameToDownload")
  let error = document.getElementById("readyError")
  let downloadButton = document.getElementById("downloadButton")

  if (uploadedFile != "") {
    let textField = document.getElementById("downloadName")
    nameToDownload.value = uploadedFile
    textField.value = task_id
    downloadButton.style.display = ""
  }

  if (readyErr != "") {
    error.style.display = ""
    downloadButton.style.display = ""
  }
</script>